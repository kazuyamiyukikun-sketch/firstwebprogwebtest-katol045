<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - WanderWise</title>
    <link rel="stylesheet" href="stylesheets.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="header-bar">
        <div class="header-elements">
            <div class="left-menu">
                <div class="logo">
                    <img src="images/icons8-location-48.png" alt="WanderWise logo">
                </div>
                <div class="header-text">
                    <p id="Wise">WanderWise Admin</p>
                    <p id="Tagline">Overview & Controls</p>
                </div>
            </div>

            <div class="right-menu">
                <div class="filter">
                    <img src="images/icons8-settings-50.png" alt="Settings">
                    <p>Admin</p>
                </div>
            </div>
        </div>
    </div>

    <main>
        <div class="map-card">
            <div class="sidebar-container">
                <div class="sidebar-top">
                    <img src="images/icons8-dashboard-48.png" alt="icon">
                    <h2>Dashboard</h2>
                </div>

                <hr>

                <div class="scroll-area" style="padding-bottom:8px;">
                    <div class="card">
                        <h3>üìä INPUT: Enter Tourist Data</h3>
                        <p style="font-size:12px;color:#666;">Source: Philippine Government Tourism Data</p>
                        <form id="dataInputForm" style="display:flex;flex-direction:column;gap:8px;">
                            <div>
                                <label style="font-size:12px;">Destination:</label>
                                <select id="destSelect" style="width:100%;padding:6px;border-radius:4px;border:1px solid #ddd;">
                                    <option value="burnham">Burnham Park</option>
                                    <option value="minesview">Mines View Park</option>
                                    <option value="wright">Wright Park</option>
                                    <option value="botanical">Botanical Garden</option>
                                    <option value="johnhay">Camp John Hay</option>
                                </select>
                            </div>
                            <div>
                                <label style="font-size:12px;">Date:</label>
                                <input type="date" id="dataDate" style="width:100%;padding:6px;border-radius:4px;border:1px solid #ddd;">
                            </div>
                            <div>
                                <label style="font-size:12px;">Hourly Visitors (comma-separated 24 values):</label>
                                <textarea id="hourlyData" rows="3" style="width:100%;padding:6px;border-radius:4px;border:1px solid #ddd;font-size:11px;font-family:monospace;"></textarea>
                            </div>
                            <div>
                                <label style="font-size:12px;">Total Daily Visitors:</label>
                                <input type="number" id="dailyTotal" placeholder="1000" style="width:100%;padding:6px;border-radius:4px;border:1px solid #ddd;">
                            </div>
                            <button type="submit" style="padding:8px;background:#3498db;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:600;">Process & Save</button>
                        </form>
                    </div>

                    <div class="card">
                        <h3>üìà OUTPUT: Data Summary</h3>
                        <p>Last Update: <strong id="lastUpdate">--</strong></p>
                        <div id="outputSummary" style="font-size:13px;line-height:1.6;">
                            <p>No data processed yet.</p>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‚öôÔ∏è PROCESS Log</h3>
                        <p id="processLog" style="font-size:12px;background:#f7f7f7;padding:8px;border-radius:4px;max-height:120px;overflow-y:auto;">Ready to process data...</p>
                    </div>

                    <div class="card">
                        <h3>Destinations</h3>
                        <table style="width:100%;font-size:13px;border-collapse:collapse;">
                            <thead>
                                <tr><th style="text-align:left;padding:6px 0;">Name</th><th style="text-align:right;padding:6px 0;">Avg/day</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>Burnham Park</td><td style="text-align:right">~2,000</td></tr>
                                <tr><td>Mines View Park</td><td style="text-align:right">~1,500</td></tr>
                                <tr><td>Wright Park</td><td style="text-align:right">~800</td></tr>
                                <tr><td>Botanical Garden</td><td style="text-align:right">~400</td></tr>
                                <tr><td>Camp John Hay</td><td style="text-align:right">~900</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <h3>üìã Live Data Sources</h3>
                        <p style="font-size:12px;"><strong>Philippine Government:</strong></p>
                        <p style="font-size:11px;">‚úì Department of Tourism<br>‚úì Baguio City Tourism Office<br>‚úì Local Government Statistics</p>
                        <p><a href="index.html" style="color:#3498db;text-decoration:none;">‚Üí Open Public Map</a></p>
                    </div>
                </div>
            </div>

            <div class="map-viewport" style="margin-right:120px;">
                <div style="display:flex;gap:12px;flex-direction:column;height:100%;padding:12px;">
                    <div style="display:flex;gap:12px;">
                        <div style="flex:1;background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.06);">
                            <h4 style="margin:0 0 8px 0">Visitors Today</h4>
                            <p style="font-size:24px;margin:6px 0;">~1,120</p>
                        </div>
                        <div style="flex:1;background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.06);">
                            <h4 style="margin:0 0 8px 0">Active Alerts</h4>
                            <p style="font-size:24px;margin:6px 0;">1</p>
                        </div>
                    </div>

                    <div style="flex:1;background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.06);display:flex;flex-direction:column;">
                        <h4 style="margin:0 0 8px 0">Monthly Visitors (sample)</h4>
                        <canvas id="adminChart" style="flex:1;max-height:260px;"></canvas>
                    </div>

                    <div style="background:#fff;padding:12px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.06);">
                        <h4 style="margin:0 0 8px 0">Notes</h4>
                        <p style="margin:0;">This admin dashboard is based on index.html layout and stylesheets.css styling. Customize metrics as needed.</p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script>
        // Data storage (localStorage for persistence)
        let processedData = JSON.parse(localStorage.getItem('wanderwiseData') || '{}');

        // INPUT: Handle form submission
        const form = document.getElementById('dataInputForm');
        const processLog = document.getElementById('processLog');
        const outputSummary = document.getElementById('outputSummary');
        const lastUpdate = document.getElementById('lastUpdate');

        function addLog(msg) {
            const log = processLog.textContent || '';
            processLog.textContent = msg + '\n' + log.split('\n').slice(0, 9).join('\n');
        }

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const dest = document.getElementById('destSelect').value;
            const date = document.getElementById('dataDate').value;
            const hourlyStr = document.getElementById('hourlyData').value;
            const dailyTotal = parseInt(document.getElementById('dailyTotal').value) || 0;

            // PROCESS: Validate and parse input
            addLog('üì• Processing input...');
            
            if (!dest || !date) {
                addLog('‚ùå Error: Destination and date required');
                return;
            }

            let hourly = [];
            if (hourlyStr.trim()) {
                try {
                    hourly = hourlyStr.split(',').map(v => parseInt(v.trim())).filter(v => !isNaN(v));
                    if (hourly.length !== 24) {
                        addLog(`‚ö†Ô∏è Warning: Expected 24 hourly values, got ${hourly.length}`);
                    }
                } catch (err) {
                    addLog('‚ùå Error parsing hourly data: ' + err.message);
                    return;
                }
            }

            // Calculate sum from hourly if not provided
            const calculatedSum = hourly.reduce((a, b) => a + b, 0);
            const finalDaily = dailyTotal || calculatedSum;

            // Store data
            if (!processedData[dest]) processedData[dest] = [];
            processedData[dest].push({ date, hourly, dailyTotal: finalDaily });
            localStorage.setItem('wanderwiseData', JSON.stringify(processedData));

            addLog(`‚úÖ Data saved for ${dest} on ${date}`);
            addLog(`üìä Daily total: ${finalDaily} visitors`);
            if (hourly.length > 0) {
                addLog(`‚è∞ Hourly range: ${Math.min(...hourly)}-${Math.max(...hourly)}`);
            }

            // OUTPUT: Display summary
            const now = new Date().toLocaleString();
            lastUpdate.textContent = now;

            let summary = `<strong>Latest Entry:</strong><br>`;
            summary += `Destination: <strong>${dest.toUpperCase()}</strong><br>`;
            summary += `Date: <strong>${date}</strong><br>`;
            summary += `Daily Total: <strong>${finalDaily} visitors</strong><br>`;
            if (hourly.length > 0) {
                const peak = Math.max(...hourly);
                const peakIdx = hourly.indexOf(peak);
                summary += `Peak Hour: <strong>${peakIdx}:00 (${peak} visitors)</strong><br>`;
                summary += `Hourly Avg: <strong>${Math.round(finalDaily / 24)}</strong>`;
            }
            outputSummary.innerHTML = summary;

            // Reset form
            form.reset();
            document.getElementById('dataDate').valueAsDate = new Date();
        });

        // Set today's date as default
        document.getElementById('dataDate').valueAsDate = new Date();

        // Display initial summary from stored data
        function updateOutputDisplay() {
            if (Object.keys(processedData).length === 0) {
                outputSummary.innerHTML = '<p>No data processed yet. Enter and submit data above.</p>';
                return;
            }
            let summary = '<strong>Data Stats:</strong><br>';
            for (const dest in processedData) {
                const entries = processedData[dest];
                if (entries.length > 0) {
                    const latest = entries[entries.length - 1];
                    summary += `${dest}: ${latest.dailyTotal} visitors (${latest.date})<br>`;
                }
            }
            outputSummary.innerHTML = summary;
        }
        updateOutputDisplay();

        // Small sample chart for the admin dashboard
        const ctx = document.getElementById('adminChart').getContext('2d');
        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        const sampleData = [1500,1600,1700,1800,2200,2500,2600,2400,2000,1800,1700,1600];
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: months,
                datasets: [{ label: 'Visitors', data: sampleData, borderColor: 'rgb(54,162,235)', backgroundColor: 'rgba(54,162,235,0.08)', tension: 0.2 }]
            },
            options: { responsive: true, maintainAspectRatio: false }
        });
    </script>
</body>
</html>
